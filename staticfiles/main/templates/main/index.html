{% extends 'main/base.html' %}
{% block content %}

<div class="container"> 
    <br>
    <!-- Carousel for Bootstrap 4 -->
<div id="mainCarousel" class="carousel slide mb-5 shadow rounded" data-ride="carousel" data-interval="6000">
    
    <!-- Indicators -->
    <ol class="carousel-indicators">
        <li data-target="#mainCarousel" data-slide-to="0" class="active"></li>
        <li data-target="#mainCarousel" data-slide-to="1"></li>
        <li data-target="#mainCarousel" data-slide-to="2"></li>
    </ol>
    
    <!-- Slides -->
    <div class="carousel-inner rounded">
        <!-- Slide 1 -->
        <div class="carousel-item active">
            <img src="/static/images/carousel1.jpg" class="d-block w-100" style="height: 400px; object-fit: cover;" alt="Books Collection">
            <div class="carousel-caption">  
                <h3>Welcome to NovelReviews!</h3>
                <p>Discover thousands of books, manga, comics, and novels</p>
            </div>
        </div>
        
        <!-- Slide 2 -->
        <div class="carousel-item">
            <img src="/static/images/carousel2.jpg" class="d-block w-100" style="height: 400px; object-fit: cover;" alt="Reading Community">
            <div class="carousel-caption">  
                <h3>Share Your Thoughts</h3>
                <p>Write reviews and help other readers discover great content</p>
            </div>
        </div>
        
        <!-- Slide 3 -->
        <div class="carousel-item">
            <img src="/static/images/carousel3.jpg" class="d-block w-100" style="height: 400px; object-fit: cover;" alt="Book Discussion">
            <div class="carousel-caption">  
                <h3>Your opinion matters</h3>
                <p>Join us now</p>
            </div>
        </div>
    </div>
    
    <!-- Navigation controls -->
    <a class="carousel-control-prev" href="#mainCarousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#mainCarousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
</div>

    <div class="mb-4">
        <div class="d-flex flex-wrap gap-2">
            <a href="{% url 'main:home' %}{% if search_query %}?title={{ search_query }}{% endif %}" 
               class="badge {% if not selected_genre %}bg-primary{% else %}bg-light text-dark{% endif %} p-2 text-decoration-none">
               All
            </a>
            {% for genre in genres %}
            <a href="{% url 'main:home' %}?genre={{ genre.id }}{% if search_query %}&title={{ search_query }}{% endif %}" 
               class="badge {% if selected_genre == genre.id|stringformat:'s' %}bg-primary{% else %}bg-light text-dark{% endif %} p-2 text-decoration-none">
               {{ genre.name }}
            </a>
            {% endfor %}
        </div>
    </div>
    <br>
    <div class="card" id="backdrop">
        <div class="card-body">
            <div class="row">
                {% for novel in novels %}
                <div class="col-md-4 mb-4">  
    <div class="card h-100">  
        <div class="card-body d-flex flex-column p-0">
            <div class="book-cover-container">
                <img src="{{ novel.image }}" alt="{{ novel.name }}" 
                     class="book-cover-img">
            </div>
            
            <div class="p-3 d-flex flex-column flex-grow-1">
                <h3 class="text-center h5 mb-2">{{ novel.name }}</h3>
                
                <div class="text-center mb-2">
                    <div class="rating-info">
                        {% if novel.average_rating %}
                            <span class="fw-bold">â˜… {{ novel.average_rating|floatformat:1 }}/10</span>
                        {% else %}
                            <span class="text-muted">No ratings yet</span>
                        {% endif %}
                        
                        {% if novel.review_count %}
                            <small class="text-muted">({{ novel.review_count }} review{{ novel.review_count|pluralize }})</small>
                        {% endif %}
                    </div>
                </div>
                
                <div class="text-center mt-auto">  
                    <a href="{% url 'main:detail' novel.id %}" class="btn btn-outline-pink">Read more</a>
                </div>
            </div>
        </div>  
    </div>
</div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

{% endblock %}